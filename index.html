<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>For You ‚ù§Ô∏è</title>
    <link href="https://fonts.googleapis.com/css2?family=Special+Elite&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        /* --- LOADING SCREEN --- */
        #loading-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #fff5f5; z-index: 1000000;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            font-family: 'Poppins', sans-serif;
        }
        .loader-bar-container {
            width: 200px; height: 10px; background: #eee;
            border-radius: 10px; margin-top: 20px; overflow: hidden;
        }
        #loader-bar { width: 0%; height: 100%; background: #ff4d6d; transition: width 0.1s; }

        /* --- BASE SETUP --- */
        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            font-family: 'Poppins', sans-serif;
            /* NEW: Red gingham background image */
            background-image: url('static/images/checkered-bg.jpg');
            background-size: 200px 200px; /* Tile the pattern */
            background-repeat: repeat;
            overflow: hidden; touch-action: manipulation;
        }

        /* --- HEART TRAIL --- */
        .heart-trail {
            position: fixed; font-size: 20px; pointer-events: none; z-index: 999999;
            font-family: sans-serif !important;
            transition: transform 1.2s ease-out, opacity 1.2s ease-out;
        }

        /* --- POLAROIDS --- */
        .polaroid-scatter {
            position: absolute; background: white; padding: 8px 8px 20px 8px;
            width: 90px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); z-index: 1;
        }
        .polaroid-scatter img { width: 100%; aspect-ratio: 1; object-fit: cover; }
        .tape { position: absolute; width: 50px; height: 20px; top: -10px; left: 50%; transform: translateX(-50%); opacity: 0.8; z-index: 2; }
        .tape-dots { background: #ff4d6d; background-image: radial-gradient(white 10%, transparent 11%); background-size: 5px 5px; }
        .tape-stripes { background: #4db8ff; background-image: linear-gradient(45deg, rgba(255,255,255,.2) 25%, transparent 25%); background-size: 4px 4px; }
        
        #p1 { top: 5%; left: 5%; transform: rotate(-10deg); }
        #p2 { top: 12%; right: 5%; transform: rotate(15deg); }
        #p3 { bottom: 8%; left: 6%; transform: rotate(-8deg); }
        #p4 { bottom: 25%; right: 5%; transform: rotate(8deg); }
        #p5 { top: 40%; left: 3%; transform: rotate(-12deg); }
        #p6 { top: 45%; right: 2%; transform: rotate(-5deg); }
        #p7 { top: 3%; left: 45%; transform: rotate(5deg); }
        #p8 { bottom: 6%; left: 42%; transform: rotate(-4deg); }

        /* --- UI PAGES --- */
        .page { display: none; width: 100%; height: 100vh; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        #page1 { display: flex; }

        /* --- MAIN CARD (NEW: Torn paper background) --- */
        .main-card {
            /* Uses your torn paper image [cite: 18, 107] */
            background-image: url('static/images/torn-paper.png');
    
            /* "cover" ensures the paper expands to fill the entire card area [cite: 21, 61] */
            background-size: cover; 
            background-repeat: no-repeat;
            background-position: center;
            background-color: transparent;
    
            /* Padding keeps text and buttons away from the very edges of the paper [cite: 12, 106] */
            padding: 30px 25px; 
    
            border-radius: 0; 
            z-index: 100; 
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    
            /* Slightly wider card to give the ransom letters more room [cite: 21] */
            width: 95%; 
            max-width: 380px;
    
            display: flex;
            flex-direction: column;
            justify-content: center;
            box-sizing: border-box; /* Ensures the card doesn't exceed screen width [cite: 81, 156] */
        }

        /* --- PAPER CLIP (NEW) - Single clip on top-right --- */
        .paper-clip {
            position: absolute;
            width: 40px; /* Slightly larger clip for the larger card [cite: 25] */
            height: auto;
            z-index: 101;
            filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.3));
            top: -10px;
            right: 15%; /* Adjusted position [cite: 76, 115] */
            transform: rotate(10deg);
        }

        /* --- RANSOM TEXT (UPGRADED) --- */
        .ransom {
            display: flex;
            flex-wrap: wrap; 
            justify-content: center;
            gap: 2px;
            margin: 10px 0;
        }

        /* NEW: Colorful ransom letters like magazine cutouts */
        .ransom span {
            display: inline-block; 
            padding: 3px 5px;
            margin: 2px;
            /* Will be set dynamically by JS for each letter */
            font-family: 'Special Elite', cursive;
            font-weight: bold;
            box-shadow: 2px 2px 4px rgba(0,0,0,0.2); /* Cut-out shadow effect */
        }
        
        .emoji-span { 
            font-family: sans-serif !important; 
            display: inline-block; 
            vertical-align: middle;
            background: transparent !important;
            box-shadow: none !important;
        }

        .btn-container { 
            display: flex; 
            gap: 15px; 
            justify-content: center; 
            margin-top: 10px; 
            min-height: 40px; 
        }
        
        button {
            font-family: 'Poppins', sans-serif; font-weight: 600;
            padding: 12px 25px; border-radius: 10px; border: none; cursor: pointer;
            transition: 0.2s;
        }

        #yes { background: #ff4d6d; color: white; }
        #no { background: #8e8e8e; color: white; position: relative; }

        video { 
            width: 65%;
            border-radius: 10px; 
            margin: 0 auto 10px auto;
            display: block;
            border: 3px solid white; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); 
        }
        
        /* MOBILE FIX: Smaller video on mobile so button stays visible */
        @media (max-width: 600px) {
            video {
                width: 55%; /* Even smaller on mobile */
                margin: 0 auto 8px auto;
            }
            
            .main-card {
                padding: 15px; /* Tighter padding on mobile */
                max-width: 320px;
            }
            
            .ransom {
                margin: 8px 0; /* Reduce margins */
            }
            
            .polaroid-inline {
                width: 80px; /* Smaller polaroids on mobile */
            }
            
            button {
                padding: 10px 20px; /* Smaller buttons */
                font-size: 0.9rem;
            }
        }
        
        .polaroid-inline { 
            background: white; 
            padding: 5px 5px 15px; 
            width: 100px; 
            box-shadow: 0 5px 10px rgba(0,0,0,0.1); 
        }
        /* Smaller, tucked phone case */
        #phone-case-easter-egg {
            position: fixed;
            bottom: -30px; /* Tucked slightly more */
            right: -10px;
            width: 100px; /* Decreased size as requested */
            transform: rotate(-12deg);
            cursor: pointer;
            z-index: 200;
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        #phone-case-easter-egg:hover {
            /* Subtle "pick me up" hint */
            transform: rotate(-5deg) scale(1.1) translateY(-5px);
        }

        /* The Letter Overlay */
        #letter-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000001;
            justify-content: center;
            align-items: center;
        }

        .letter-content {
            background: #fff;
            background-image: linear-gradient(#e1e1e1 1px, transparent 1px);
            background-size: 100% 25px; /* Lined paper look */
            padding: 40px;
            width: 80%;
            max-width: 400px;
            font-family: 'Special Elite', cursive;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            transform: rotate(2deg);
            position: relative;
        }
    </style>
</head>
<body>

    <div id="loading-screen">
        <div style="font-size: 40px;">‚ù§Ô∏è</div>
        <p id="loading-text">Loading surprise... 0%</p>
        <div class="loader-bar-container"><div id="loader-bar"></div></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <audio id="bgMusic" loop><source src="static/bg-music.mp3" type="audio/mpeg"></audio>

    <section id="page1" class="page">
        <div class="polaroid-scatter" id="p1"><div class="tape tape-dots"></div><img src="static/images/wish1.jpg"></div>
        <div class="polaroid-scatter" id="p2"><div class="tape tape-stripes"></div><img src="static/images/wish2.jpg"></div>
        <div class="polaroid-scatter" id="p3"><div class="tape tape-dots"></div><img src="static/images/wish3.jpg"></div>
        <div class="polaroid-scatter" id="p4"><div class="tape tape-stripes"></div><img src="static/images/wish4.jpg"></div>
        <div class="polaroid-scatter" id="p5"><div class="tape tape-dots"></div><img src="static/images/wish5.jpg"></div>
        <div class="polaroid-scatter" id="p6"><div class="tape tape-stripes"></div><img src="static/images/wish6.jpg"></div>
        <div class="polaroid-scatter" id="p7"><div class="tape tape-dots"></div><img src="static/images/wish7.jpg"></div>
        <div class="polaroid-scatter" id="p8"><div class="tape tape-stripes"></div><img src="static/images/wish8.jpg"></div>

        <div class="main-card">
            <!-- NEW: Single paper clip on top-right -->
            <img src="static/images/paper-clip.png" class="paper-clip" alt="">
            
            <h1 class="ransom" id="t1">Happy Birthday Gorgeous! <span class="emoji-span">üéÇ</span></h1>
            <button style="background:#ff4d6d; color:white;" onclick="startExperience()">Oru question... ‚ù§Ô∏è</button>
        </div>
    </section>

    <section id="page2" class="page">
        <div class="main-card">
            <!-- NEW: Single paper clip on top-right -->
            <img src="static/images/paper-clip.png" class="paper-clip" alt="">
            
            <video autoplay loop muted playsinline><source src="static/images/kisses.mp4" type="video/mp4"></video>
            <h1 class="ransom" id="t2">KEERTHIIIII! MyLOUUUU, will you be my Valentine?(please<span class="emoji-span">üòû</span>)</h1>
            <div class="btn-container">
                <button id="yes" onclick="goToYesPage()">Yes</button>
                <button id="no" onmouseover="moveNo()" onclick="moveNo()">No</button>
            </div>
        </div>
    </section>

    <section id="page3" class="page">
        <div class="main-card">
            <!-- NEW: Single paper clip on top-right -->
            <img src="static/images/paper-clip.png" class="paper-clip" alt="">
            
            <video autoplay loop muted playsinline><source src="static/images/kisses1.mp4" type="video/mp4"></video>
            <h1 class="ransom" id="t3">UGHHHHHH I Looveee YOU SOOOOO MUCH BABYYYYY<span class="emoji-span">‚ù§Ô∏è</span></h1>
            <div style="display: flex; gap: 10px; justify-content: center; margin: 15px 0;">
                <div class="polaroid-inline"><img src="static/images/pic1.jpg" style="width:100%"></div>
                <div class="polaroid-inline" style="transform: rotate(5deg);"><img src="static/images/pic2.jpg" style="width:100%"></div>
            </div>
            <button style="background: white; color: #ff4d6d; border: 2px solid #ff4d6d;" onclick="goToFinalVideo()">Sheri Enna üëã</button>
        </div>
    </section>

    <section id="page4" class="page" style="background:#000;">
        <video id="finalVid" controls playsinline style="width:100%; height:100%; object-fit: contain;">
            <source src="static/images/vid1.mp4" type="video/mp4">
        </video>
    </section>

    <script>
        // --- LOADING BAR LOGIC (PRESERVED) ---
        let progress = 0;
        const interval = setInterval(() => {
            progress += Math.random() * 10;
            if (progress >= 100) {
                progress = 100;
                clearInterval(interval);
                setTimeout(() => {
                    document.getElementById('loading-screen').style.display = 'none';
                }, 500);
            }
            document.getElementById('loader-bar').style.width = progress + '%';
            document.getElementById('loading-text').innerText = `Loading surprise... ${Math.floor(progress)}%`;
        }, 150);

        // --- UPGRADED RANSOM FUNCTION (NEW: Colorful magazine cutout effect) ---
        function applyRansom(id) {
            const el = document.getElementById(id);
            const html = el.innerHTML;
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = html;
            const nodes = Array.from(tempDiv.childNodes);
            el.innerHTML = '';
    
            // NEW: Color palettes for magazine cutout look
            const bgColors = [
                '#ff4d6d', '#ffcc00', '#4db8ff', '#ff66b2', 
                '#66ff66', '#ff9933', '#ff6b9d', '#00d4ff',
                '#ffd93d', '#6bcf7f', '#c77dff', '#ff5757'
            ];
            const textColors = ['#000000', '#ffffff', '#8B0000', '#001f3f', '#2c3e50'];
            const fonts = [
                'Arial Black', 'Georgia', 'Courier New', 'Impact', 
                'Times New Roman', 'Verdana', 'Comic Sans MS', 'Trebuchet MS'
            ];

            nodes.forEach(node => {
                if (node.nodeType === 3) { // Text node
                    node.textContent.split(' ').forEach(word => {
                        if(word.trim() === "") return;
                        const wordSpan = document.createElement('span');
                        wordSpan.style.display = 'inline-block';
                        wordSpan.style.whiteSpace = 'nowrap';
                        wordSpan.style.margin = '3px';
                        
                        word.split('').forEach(char => {
                            const span = document.createElement('span');
                            span.innerText = char;
                            
                            // NEW: Random colorful styling for each letter
                            span.style.backgroundColor = bgColors[Math.floor(Math.random() * bgColors.length)];
                            span.style.color = textColors[Math.floor(Math.random() * textColors.length)];
                            span.style.fontFamily = fonts[Math.floor(Math.random() * fonts.length)];
                            span.style.fontSize = (Math.random() * 0.2 + 0.8) + 'rem'; // 0.95-1.25rem
                            span.style.transform = `rotate(${(Math.random()*12)-6}deg)`; // -6 to +6 degrees
                            span.style.fontWeight = Math.random() > 0.5 ? 'bold' : 'normal';
                            span.style.fontStyle = Math.random() > 0.7 ? 'italic' : 'normal';
                            
                            wordSpan.appendChild(span);
                        });
                        el.appendChild(wordSpan);
                    });
                } else { 
                    el.appendChild(node.cloneNode(true)); 
                }
            });
        }
        
        applyRansom('t1');

        // --- ALL EXISTING FUNCTIONS PRESERVED ---
        function startExperience() {
            document.getElementById('bgMusic').play().catch(() => {});
            showPage('page2');
            applyRansom('t2');
        }
        
        function goToYesPage() {
            showPage('page3');
            applyRansom('t3');
            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
        }
        
        function goToFinalVideo() {
            document.getElementById('bgMusic').pause();
            showPage('page4');
            document.getElementById('finalVid').play();
        }
        
        function showPage(id) {
            document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
            document.getElementById(id).style.display = 'flex';
        }

        let yesScale = 1;
        function moveNo() {
            const no = document.getElementById("no");
            const yes = document.getElementById("yes");
            no.style.position = "fixed";
            no.style.left = Math.random() * (window.innerWidth - 100) + "px";
            no.style.top = Math.random() * (window.innerHeight - 50) + "px";
            yesScale += 0.2;
            yes.style.transform = `scale(${yesScale})`;
        }

        // --- HEART TRAIL (PRESERVED) ---
        document.addEventListener('mousemove', (e) => {
            if (Math.random() > 0.3) {
                const h = document.createElement('div');
                h.className = 'heart-trail'; h.innerHTML = '‚ù§Ô∏è';
                h.style.left = e.clientX + 'px'; h.style.top = e.clientY + 'px';
                document.body.appendChild(h);
                setTimeout(() => {
                    h.style.transform = `translate(${(Math.random()-0.5)*100}px, -100px) scale(1.5)`;
                    h.style.opacity = '0';
                }, 50);
                setTimeout(() => h.remove(), 1000);
            }
        });
        function openLetter() {
            document.getElementById('letter-overlay').style.display = 'flex';
        }

        function closeLetter() {
            document.getElementById('letter-overlay').style.display = 'none';
        }
    </script>
    <img src="static/images/phone-case.png" id="phone-case-easter-egg" onclick="openLetter()">

        <div id="letter-overlay" onclick="closeLetter()">
            <div class="letter-content" onclick="event.stopPropagation()">
                <h3>My Dearest...</h3>
                <p>Write your heartfelt letter here. Mention the 4 years, the school souvenir, and what it means to you.</p>
                <p style="text-align: right;">‚ù§Ô∏è Your Name</p>
                <button onclick="closeLetter()" style="margin-top: 20px; background: #ff4d6d; color: white;">Close</button>
            </div>
        </div>
</body>
</html>
